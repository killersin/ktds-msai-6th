# Azure CLI 도구를 통한 Azure AI Search Index 생성

```
az login
```
웹 브라우저 탭이 열리고 Azure에 로그인하라는 메시지가 표시됩니다. 이렇게 한 다음 브라우저 탭을 닫고 Visual Studio Code로 돌아갑니다. 다음 명령을 입력하여 배치 파일을 실행합니다. 이렇게 하면 스토리지 계정에 Blob 컨테이너가 만들어지고 데이터 폴더의 문서가 업로드됩니다.

```
.\UploadDocs.cmd
```

## 문서 인덱싱
이제 문서가 준비되었으므로 문서를 인덱싱하여 검색 솔루션을 만들 수 있습니다.
1.	Azure Portal에서 Azure AI Search 리소스로 이동합니다. 그런 다음 개요 페이지에서 데이터 가져오기를 선택합니다.

2.	데이터에 연결 페이지의 데이터 원본 목록에서 Azure Blob Storage를 선택합니다. 그런 다음, 다음 값으로 데이터 저장소 세부 정보를 입력합니다.
- 데이터 원본: Azure Blob Storage
- 데이터 원본 이름: margies-data
- 추출할 데이터: 콘텐츠 및 메타데이터
- 구문 분석 모드: 기본값
- 연결 문자열: 기존 연결 선택을 선택합니다. 그런 다음, 스토리지 계정을 선택하고 마지막으로 UploadDocs.cmd 스크립트에서 만든 margies 컨테이너를 선택합니다.
- 관리 ID 인증: 없음
- 컨테이너 이름: margies
- Blob 폴더: 비워 둡니다.
- 설명: Margie's Travel 웹 사이트의 브로셔 및 리뷰.

3.	다음 단계(인식 기술 추가)로 진행합니다.

4.	Azure AI Services 연결 섹션에서 Azure AI Services 리소스를 선택합니다.

5.	Add enrichments 섹션에서:
- Skillset 이름을 margies-skillset으로 변경합니다.
- OCR을 활성화하고 모든 텍스트를 merged_content 필드에 병합 옵션을 선택합니다.
- 소스 데이터 필드가 merged_content로 설정되어 있는지 확인합니다.
- Enrichment granularity level을 Source field(소스 필드)로 유지하면 인덱싱되는 문서의 전체 콘텐츠가 설정됩니다. 그러나 페이지나 문장과 같은 보다 세분화된 수준에서 정보를 추출하도록 변경할 수 있습니다.
- 다음 보강된 필드를 선택합니다.

|인지 능력|매개 변수|
|--------|-------| 
|위치 이름 추출|위치|
|핵심 구 추출|핵심 문구|
|언어 검색|언어|
|이미지에서 태그 생성|image 태그|
|이미지에서 캡션 생성|이미지 캡션|

6.	선택 항목을 다시 확인합니다(나중에 변경하기 어려울 수 있음). 그런 다음 다음 단계(대상 인덱스 사용자 지정)로 진행합니다.

7.	인덱스 이름을 margies-index로 변경합니다.

8.	키가 metadata_storage_path로 설정되어 있는지 확인하고 Suggester 이름을 비워 두고 Search mode(검색 모드)를 기본값으로 둡니다.

9.	인덱스 필드를 다음과 같이 변경하고 다른 모든 필드는 기본 설정으로 둡니다(중요: 전체 테이블을 보려면 오른쪽으로 스크롤해야 할 수도 있음).

|필드 이름|조회가능|필터링 가능|정렬 가능|패싯  기능|검색|
|----|----|----|----|----|----|
|metadata_storage_size|✔|✔|✔||
|metadata_storage_last_modified|✔|✔|✔||
|metadata_storage_name|✔|✔|✔||✔|
|metadata_author||✔|✔|✔|✔|✔|
|위치|✔|✔|||✔|
|핵심 문구|✔|✔|||✔|
|언어|✔|✔|||✔|

10.	선택 항목을 다시 확인하고 각 필드에 대해 올바른 검색 가능, 필터링 가능, 정렬 가능, 패싯 가능 및 검색 가능 옵션이 선택되어 있는지 특히 주의하십시오(나중에 변경하기 어려울 수 있음). 그런 다음, 다음 단계(인덱서 만들기)로 진행합니다.

11.	Change the Indexer name to margies-indexer.

12.	Schedule(일정)을 Once(한 번)로 설정된 상태로 둡니다.

13.	제출을 선택하여 데이터 원본, 기술 세트, 인덱스 및 인덱서를 만듭니다. 인덱서는 자동으로 실행되며 인덱싱 파이프라인을 실행합니다.

- 데이터 소스에서 문서 메타데이터 필드와 콘텐츠를 추출합니다
- 추가 보강된 필드를 생성하기 위해 인지 기술의 기술 세트를 실행합니다.
- 추출된 필드를 인덱스에 매핑합니다.

15.	왼쪽에서 새로 생성된 margies-indexer가 표시되는 Indexers 페이지를 확인합니다. 몇 분 정도 기다렸다가 상태가 성공을 나타낼 때까지 ↻ 새로 고침을 클릭합니다.