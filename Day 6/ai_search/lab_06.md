# 검색 클라이언트 응용 프로그램 만들기
이제 유용한 인덱스가 있으므로 클라이언트 응용 프로그램에서 사용할 수 있습니다. REST 인터페이스를 사용하고, 요청을 제출하고, HTTP를 통해 JSON 형식으로 응답을 수신하여 이 작업을 수행할 수 있습니다. 또는 선호하는 프로그래밍 언어에 대한 SDK(소프트웨어 개발 키트)를 사용할 수 있습니다. 이 연습에서는 SDK를 사용합니다.

> 참고: C# 또는 Python용 SDK를 사용하도록 선택할 수 있습니다. 아래 단계에서 기본 설정 언어에 적합한 작업을 수행합니다.

## 검색 리소스에 대한 엔드포인트 및 키 가져오기

1.	Azure Portal의 Azure AI Search 리소스에 대한 개요 페이지에서 https:// your_resource_name.search.windows.net 와 유사해야 하는 URL 값을 기록해 둡니다. 이는 검색 리소스의 엔드포인트입니다.

2.	키 페이지에는 두 개의 관리자 키와 하나의 쿼리 키가 있습니다. 관리자 키는 검색 리소스를 만들고 관리하는 데 사용됩니다. 쿼리 키는 검색 쿼리만 수행해야 하는 클라이언트 응용 프로그램에서 사용됩니다. 클라이언트 응용 프로그램에 대한 끝점 및 쿼리 키가 필요합니다.

## Azure AI Search SDK 사용 준비
1.	Visual Studio Code의 탐색기 창에서 01-azure-search 폴더로 이동하여 언어 기본 설정에 따라 C-Sharp 또는 Python 폴더를 확장합니다.

2.	margies-travel 폴더를 마우스 오른쪽 버튼으로 클릭하고 통합 터미널을 엽니다. 그런 다음, 언어 기본 설정에 적합한 명령을 실행하여 Azure AI Search SDK 패키지를 설치합니다.

C#
```C#
dotnet add package Azure.Search.Documents --version 11.6.0
```
Python
```python
pip install azure-search-documents==11.5.1
```

3.	margies-travel 폴더의 내용을 보고 구성 설정에 대한 파일이 포함되어 있는지 확인합니다.
- C#: appsettings.json
- Python: .env
- 구성 파일을 열고 포함된 구성 값을 업데이트하여 Azure AI Search 리소스에 대한 엔드포인트 및 쿼리 키를 반영합니다. 변경 사항을 저장합니다.

## 코드를 탐색하여 인덱스 검색
margies-travel 폴더에는 검색 기능이 포함된 웹 애플리케이션(Microsoft C# ASP.NET Razor 웹 애플리케이션 또는 Python Flask 애플리케이션)에 대한 코드 파일이 포함되어 있습니다.

1.	선택한 프로그래밍 언어에 따라 웹 애플리케이션에서 다음 코드 파일을 엽니다.
- C#:Package/Index.cshtml.cs
- Python: app.py

2.	코드 파일의 맨 위에서 Import search namespaces(검색 네임스페이스 가져오기) 주석을 찾고, Azure AI Search SDK에서 작동하도록 가져온 네임스페이스를 확인합니다.

3.	search_query 함수에서 검색 클라이언트 만들기 주석을 찾고, 이 코드는 Azure AI Search 리소스에 대한 엔드포인트 및 쿼리 키를 사용하여 SearchClient 개체를 만듭니다.

4.	search_query 함수에서 Submit search query(검색 쿼리 제출) 주석을 찾고, 다음 옵션을 사용하여 지정된 텍스트에 대한 검색을 제출하는 코드를 검토합니다.

- 검색 텍스트의 모든 개별 단어를 찾아야 하는 검색 모드입니다.
- 검색에서 찾은 총 문서 수가 결과에 포함됩니다.
- 결과는 제공된 필터 표현식과 일치하는 문서만 포함하도록 필터링됩니다.
- 결과는 지정된 정렬 순서로 정렬됩니다.
- metadata_author 필드의 각 불연속 값은 필터링을 위해 미리 정의된 값을 표시하는 데 사용할 수 있는 패싯으로 반환됩니다.
- 검색어가 강조 표시된 merged_content 및 imageCaption 필드의 추출물이 최대 3개까지 결과에 포함됩니다.
- 결과에는 지정된 필드만 포함됩니다.

## 코드를 탐색하여 검색 결과 렌더링

웹 앱에는 검색 결과를 처리하고 렌더링하는 코드가 이미 포함되어 있습니다.

1.	선택한 프로그래밍 언어에 따라 웹 애플리케이션에서 다음 코드 파일을 엽니다.
- C#:Packages/Index.cshtml
- python: templates/search.html
2.	검색 결과가 표시되는 페이지를 렌더링하는 코드를 검사합니다. 다음 사항을 준수하십시오.
- 페이지는 사용자가 새 검색을 제출하는 데 사용할 수 있는 검색 양식으로 시작하며(애플리케이션의 Python 버전에서 이 양식은 base.html 템플릿에 정의되어 있음) 페이지 시작 부분에서 참조됩니다.
- 그런 다음 두 번째 양식이 렌더링되어 사용자가 검색 결과를 구체화할 수 있습니다. 이 양식의 코드는 다음과 같습니다.
- 검색 결과에서 문서 수를 검색하고 표시합니다.
- metadata_author 필드의 패싯 값을 검색하여 필터링을 위한 옵션 목록으로 표시합니다.
- 결과에 대한 정렬 옵션의 드롭다운 목록을 만듭니다.
- 그런 다음 코드는 검색 결과를 반복하여 각 결과를 다음과 같이 렌더링합니다.
- metadata_storage_name(파일 이름) 필드를 url 필드의 주소에 대한 링크로 표시합니다.
- merged_content 및 imageCaption 필드에 있는 검색어에 대한 하이라이트를 표시하여 검색어를 컨텍스트에 표시하는 데 도움이 됩니다.
- metadata_author, metadata_storage_size, metadata_storage_last_modified 및 언어 필드를 표시합니다.
- 문서에 대한 감정 레이블을 표시합니다. 양수, 음수, 중립 또는 혼합일 수 있습니다.
- 처음 5개의 키프레이즈(있는 경우)를 표시합니다.
- 처음 5개 위치(있는 경우)를 표시합니다.
- 처음 5개의 imageTag(있는 경우)를 표시합니다.

## 웹앱 실행
1.	margies-travel 폴더의 통합 터미널로 돌아가서 다음 명령을 입력하여 프로그램을 실행합니다.
C#
```C#
dotnet run
```
Python
```python
flask run
```
2. 앱이 성공적으로 시작될 때 표시되는 메시지에서 실행 중인 웹 애플리케이션(http://localhost:5000/ 또는 http://127.0.0.1:5000/)에 대한 링크를 따라 웹 브라우저에서 Margies Travel 사이트를 엽니다.

3. Margie's Travel 웹사이트에서 검색창에 London hotel을 입력하고 검색을 클릭합니다.

4. 검색 결과를 검토합니다. 여기에는 파일 이름(파일 URL에 대한 하이퍼링크 포함), 검색어(London 및 hotel)가 강조된 파일 콘텐츠 추출 및 인덱스 필드에서 파일의 기타 속성이 포함됩니다.

5. 결과 페이지에는 결과를 구체화할 수 있는 몇 가지 사용자 인터페이스 요소가 포함되어 있는지 확인합니다. 여기에는 다음이 포함됩니다.

- metadata_author 필드의 패싯 값을 기반으로 하는 필터입니다. 이는 패싯 가능 필드를 사용하여 패싯 목록(사용자 인터페이스에서 잠재적 필터 값으로 표시할 수 있는 작은 불연속 값 집합이 있는 필드)을 반환하는 방법을 보여 줍니다.
- 지정된 필드와 정렬 방향(오름차순 또는 내림차순)을 기준으로 결과를 정렬하는 기능입니다. 기본 순서는 관련성을 기반으로 하며, 이는 인덱스 필드에서 검색어의 빈도와 중요도를 평가하는 점수 매기기 프로필을 기반으로 search.score() 값으로 계산됩니다.

6. 검토자 필터와 긍정에서 음수 정렬 옵션을 선택한 다음 결과 구체화를 선택합니다.

7. 결과가 리뷰만 포함하도록 필터링되고 감정 레이블에 따라 정렬되는지 확인합니다.

8. 검색 상자에 New York의 조용한 호텔에 대한 새 검색을 입력하고 결과를 검토합니다.

9. 다음 검색어를 사용해 보세요.
- Tower of London(이 용어는 일부 문서에서 핵심 문구로 식별됨).
- skyscraper (이 단어는 문서의 실제 내용에는 나타나지 않지만 일부 문서의 이미지에 대해 생성된 이미지 캡션 및 이미지 태그에서 찾을 수 있습니다.)
- 모하비 사막 (이 용어는 일부 문서에서 위치로 식별됨).

10. Margie's Travel 웹 사이트가 포함된 브라우저 탭을 닫고 Visual Studio Code로 돌아갑니다. 그런 다음, margies-travel 폴더(dotnet 또는 flask 애플리케이션이 실행 중인 위치)의 Python 터미널에서 Ctrl+C를 입력하여 앱을 중지합니다.
정리
이제 연습을 완료했으므로 더 이상 필요하지 않은 모든 리소스를 삭제합니다. Azure 리소스를 삭제합니다.
11. Azure Portal에서 리소스 그룹을 선택합니다.

12. 필요하지 않은 리소스 그룹을 선택한 다음, 리소스 그룹 삭제를 선택합니다.

> 추가 정보: Azure AI Search에 대한 자세한 내용은 Azure AI Search 설명서를 참조하세요.

